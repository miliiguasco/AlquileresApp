@page "/buscar"
@using AlquileresApp.UI.Components.Search
@using AlquileresApp.UI.Components.Property
@using AlquileresApp.Core.Interfaces
@using Microsoft.AspNetCore.Components.Web



@inject IPropiedadService PropiedadService

@using AlquileresApp.Core.Entidades

<HeadContent>
    <PageTitle>Buscar propiedades</PageTitle>
</HeadContent>

<div class="search-container">
    <div class="search-item">
        <LocationInput @bind-Localidad="filtros.Localidad" />
    </div>
    <div class="search-item">
        <DateRangePicker @bind-FechaInicio="filtros.FechaInicio" @bind-FechaFin="filtros.FechaFin" />
    </div>
    <div class="search-item">
        <GuestPicker @bind-Cantidad="filtros.CantidadHuespedes" />
    </div>
    <div class="search-item">
        <SearchButton OnClick="BuscarPropiedades" />
    </div>
</div>

@if (propiedadesFiltradas is not null)
{
    <PropertyList Propiedades="propiedadesFiltradas" />
}

@code {
    private SearchFilters filtros = new();
    private List<Propiedad> propiedadesFiltradas = new();

    private async Task BuscarPropiedades()
{
    propiedadesFiltradas = await PropiedadService.BuscarDisponiblesAsync(filtros);
}
}
